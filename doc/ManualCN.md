这是一份基于《军团幸存者》（Legion Survivor）项目源代码编译的完整游戏说明书。

---

# 《军团幸存者：战术网格》完整游戏说明书

## 1. 游戏概述
《军团幸存者》是一款结合了战术阵型管理、自走棋养成与 Roguelike 动作生存的游戏。玩家控制一个可以在网格中自由排列的军团，在无尽的敌群中生存。

### 核心玩法
*   **实时战斗**：通过手柄或 WASD 控制军团位移，单位会自动攻击射程内的敌人。
*   **阵型管理**：通过“战术指挥”界面，招募、移动、进化或牺牲单位。
*   **策略养成**：通过升级军团获得“教条”（被动技能），并提升单个单位的等级。

---

## 2. 基础机制

### 2.1 资源与升级
*   **金币 (Gold)**：通过击杀敌人获得。用于招募新兵（50G）、进化（100G）、复活（30G）和扩建阵型。
*   **军团等级 (Legion Level)**：通过全队杀敌经验提升。每升一级可从 3 个随机“教条”中选择一个。
*   **单位等级 (Unit Level)**：单个单位通过战斗获得经验。升级时会获得随机属性成长（攻击+1、生命+10 或 防御+1）并回满部分生命。

### 2.2 关卡系统
游戏分为四个阶段：
1.  **Stage 1 (怪物阶段)**：持续 15 分钟，主要面对各类变异怪物。进化上限限制为 T2。
2.  **Stage 2 (人类阶段)**：持续 15 分钟，面对训练有素的人类步兵、弓箭手和骑士。
3.  **Stage 3 (混合阶段)**：持续 15 分钟，怪物与人类部队混合进攻。
4.  **Endless (无尽模式)**：完成 Stage 3 后开启，难度随时间无限线性增加。

---

## 3. 军团兵种全图鉴

单位分为三个阶级（Tier），共有五大基础职业。

### 3.1 基础职业 (Tier 1)
*   **步兵 (Infantry)**：均衡型。150 HP, 12 ATK, 120 射程。
*   **弓兵 (Archer)**：远程输出。80 HP, 10 ATK, 450 射程。
*   **重甲 (Heavy Guard)**：坦克。250 HP, 8 ATK, 15 DEF, 80 射程。
*   **学徒 (Apprentice/Mage)**：范围魔法。70 HP, 18 ATK, 350 射程。
*   **侍僧 (Acolyte/Priest)**：治疗。100 HP, 10 HEAL, 300 射程。

### 3.2 进阶职业 (Tier 2 - 需要单位 5 级)
*   **步兵分支**：
    *   **剑士**：高攻速、高闪避。
    *   **枪兵**：中距离近战（180 射程），适合放第二排。
*   **弓兵分支**：
    *   **弩手**：重型单体高伤。
    *   **猎人**：极高射速，清理杂鱼。
*   **重甲分支**：
    *   **护卫**：终极坦克，500 HP, 35 DEF。
    *   **骑士**：兼顾机动性与攻击的重甲。
*   **法师分支**：
    *   **巫师**：火焰魔法，大范围爆炸。
    *   **术士**：暗影魔法，高射速长距离。
*   **牧师分支**：
    *   **牧师**：多目标群体治疗。
    *   **武僧**：前排肉搏型治疗者。

### 3.3 终极职业 (Tier 3 - 需要单位 10 级)
*   **近战类**：
    *   **圣骑士 (Holy Knight)**：高血量均衡输出。
    *   **狂战士 (Berserker)**：低血量高攻速。
    *   **方阵兵 (Phalanx)**：直线穿透攻击。
    *   **角斗士 (Gladiator)**：高暴击专家。
*   **远程类**：
    *   **狙击手 (Sniper)**：超远距离（850），优先狙杀高血量目标。
    *   **神射手 (Marksman)**：箭雨风暴。
    *   **巡林者 (Ranger)**：穿透性箭矢。
    *   **刺客 (Assassin)**：自动斩杀低血量非 Boss 敌人。
*   **防御类**：
    *   **铁壁 (Iron Wall)**：1500 HP, 90 DEF，全游最强盾牌。
    *   **帕拉丁 (Paladin)**：提供周围友军防御光环。
    *   **主宰 (Juggernaut)**：每次攻击附带强力击退。
    *   **圣殿骑士 (Templar)**：将防御转化为神圣伤害。
*   **法术类**：
    *   **大法师 (Archmage)**：连锁闪电魔法。
    *   **巫妖 (Lich)**：攻击附带吸血。
    *   **元素师 (Elementalist)**：攻击大幅减速敌人。
    *   **战斗法师 (Battlemage)**：中程范围魔法，高防御。
*   **辅助类**：
    *   **大主祭 (High Priest)**：同时治愈全军所有单位。
    *   **先知 (Prophet)**：全军高闪避增益。
    *   **圣徒 (Saint)**：极高物理防御的单体强效治疗。
    *   **枢机主教 (Bishop)**：治疗友军时对周围敌人造成伤害。

---

## 4. 敌军单位

### 4.1 怪物类
*   **Grunt (小兵)**：标准追击者。
*   **Stinger (刺蛇)**：蛇皮走位，快速突刺后撤退。
*   **Spitfire (喷火怪)**：远程喷射粘液。
*   **Titan (巨人)**：高血量 Boss 级单位。
*   **Bomber (自爆怪)**：靠近后闪烁变色，造成大范围真实伤害。
*   **Shield (盾怪)**：高防御，直线冲锋。
*   **Healer (治疗怪)**：环绕玩家，持续为其他怪物回复生命。
*   **Dasher (冲撞怪)**：蓄力后极速直线冲锋。

### 4.2 人类部队
*   **步兵 (Enemy Infantry)**：属性均衡的集群部队。
*   **弓箭手 (Enemy Archer)**：远程齐射，射程极远。
*   **骑士 (Enemy Knight)**：高血量、高机动，带冲锋技能。

---

## 5. 战术系统

### 5.1 阵型扩建
初始阵型为 3x3，可通过金币升级：
*   3x3 -> 4x4 (500G)
*   4x4 -> 5x5 (2000G)
*   5x5 -> 6x6 (6000G)
*   6x6 -> 7x7 (12000G)

### 5.2 单位退役与献祭
在战术界面拖拽单位到特定区域：
*   **退役 (Dismiss)**：销毁单位，返还 50% 招募费及等级奖励金币。
*   **献祭 (Sacrifice)**：仅限 Tier 2 及以上兵种。销毁该单位，立即获得一次高级被动技能（教条）的选择机会。

---

## 6. 教条（被动技能）列表

教条最多可携带 **10 个**，满员后获得新教条必须替换旧教条。

### 6.1 基础属性类 (Common)
*   **锋利剑刃**：近战伤害 +25%。
*   **铁甲片**：防御+8，血量+50。
*   **快速拔枪**：全队攻速 +20%。
*   **鹰眼**：射程 +40%。
*   **巨人之心**：最大生命值 +40%。
*   **贪婪**：金币获取 +30%。

### 6.2 进阶机制类 (Rare)
*   **吸血獠牙**：命中回复 3 HP。
*   **穿透射击**：投射物穿透 1 个敌人。
*   **荆棘护甲**：反弹 60% 伤害。
*   **巨人杀手**：对精英/Boss 伤害 +60%。
*   **狂战之血**：血量越低攻速越快。
*   **泰坦重击**：近战攻击附带击退。
*   **快速咏唱**：全队冷却时间 -20%。

### 6.3 核心流派类 (Legendary)
*   **分裂箭**：投射物数量+2，伤害-30%。
*   **顺劈大师**：近战攻击变为 AOE。
*   **处决者**：秒杀 20% 血量以下的非 Boss 敌人。
*   **弹射**：投射物命中后跳跃至下一个敌人。
*   **霰弹**：投射物数量+3，射程-40%。

### 6.4 阵型战术类
*   **前锋冲锋**：前排单位伤害 +50%。
*   **后勤保障**：后排单位攻速 +40%。
*   **密集阵型**：每相邻一个友军 +10 防御。
*   **核心护卫**：只要周围有队友，中心单位无敌。
*   **会员卡**：所有招募/升级费用 -30%。

### 6.5 诅咒系列 (Cursed)
*   **玻璃大炮**：伤害 +150%，生命 -60%。
*   **沉重镣铐**：防御 +300%，移速 -50%。
*   **鲜血契约**：攻速 +300%，攻击自伤 3% HP。

### 6.6 元素与特殊流派 (New)
*   **寒霜刺骨**：攻击附带 30% 减速。
*   **点燃**：攻击附带持续燃烧伤害。
*   **热能冲击**：攻击同时处于冰冻+燃烧的敌人引发爆炸。
*   **灵魂汲取**：击杀有概率召唤一个持续 10 秒的骷髅兵。
*   **金弹**：伤害随当前持有金币数量增加。
*   **磁场**：将周围敌人缓慢拉向军团。
*   **卫星**：生成 2 个围绕军团旋转的魔法球。
*   **追踪导弹**：所有投射物获得自动追踪。

---

## 7. 死亡与失败
*   单个单位死亡后，可支付金币在战术界面复活，回复 50% 生命。
*   **失败条件**：当阵型中所有单位均阵亡时，游戏结束。
*   **保命机制**：拥有“氪金致胜”教条时，受到致命伤会自动消耗 500G 瞬间回满血量。

---

## 8. 进阶阵型布局策略

由于游戏采用网格坐标系（`cellSize: 30`），单位的摆放位置直接影响生存率。

### 8.1 经典九宫格布局 (3x3)
*   **前排 (Row 0)**：放置 **护卫 (Guardian)** 或 **铁壁 (Iron Wall)**。由于前排最先接触敌人，必须配置高防御单位。
*   **中排 (Row 1)**：建议放置 **枪兵 (Spearman)** 或 **方阵兵 (Phalanx)**。这些单位拥有 180-250 的射程，可以越过前排头顶进行输出。
*   **后排 (Row 2)**：放置 **大主祭 (High Priest)** 或 **神射手 (Marksman)**。由于后排受保护较好，适合脆皮高输出或强力奶妈。

### 8.2 扩建后的侧翼战术 (5x5 - 7x7)
*   **边角位**：适合放置 **武僧 (Monk)** 或 **圣骑士 (Holy Knight)**。他们拥有较强的自保能力，可以应对从侧面切入的刺蛇 (Stinger) 或 冲撞怪 (Dasher)。
*   **核心位**：配合 **核心护卫 (Core Protection)** 教条，将最重要的输出点（如狙击手）放在阵型正中心，只要周围有一个队友存活，中心单位就不会受到伤害。

---

## 9. 敌军 AI 行为详解

了解敌人的逻辑可以更好地通过走位躲避伤害：

*   **刺蛇 (Stinger)**：采用“蛇皮走位”（`Math.sin(time/200)`）。它们在接近玩家 150 距离时会发动突刺，停留 0.3 秒后强制后撤。
*   **冲撞怪 (Dasher)**：
    *   **蓄力期**：距离玩家 350 以内时，身体变红并后退（蓄势）。
    *   **冲击期**：以 6 倍移动速度直线冲向玩家锁定时的坐标。
    *   **僵直期**：冲刺 0.4 秒后变灰，停止行动 1.5 秒。
*   **自爆怪 (Bomber)**：在 100 距离内触发爆炸倒计时（0.8 秒），期间会剧烈闪烁。爆炸对 180 范围内的单位造成大量伤害。
*   **治疗师 (Healer)**：始终尝试与玩家保持 350-500 的距离。如果距离太近会逃跑，如果太远会靠近，并在 CD 结束后治愈生命值最低的怪物。

---

## 10. 底层数值计算公式 (The Math)

### 10.1 单位基础属性 (Base Stats)
*   **基础攻击力** = `ClassBaseDamage * (1 + (Level-1) * 0.15) + BonusDamage`
*   **基础生命值** = `ClassBaseHealth * (1 + (Level-1) * 0.15) + BonusHealth`
*   **军团增益**：每提升一级军团等级，全队获得 5% 的全局伤害加成。

### 10.2 最终伤害判定 (Final Damage)
`FinalDamage = (BaseDamage * LegionBonus * PassiveMultipliers) - TargetDefense`
*   注：伤害最小保底为 1 点。

### 10.3 攻速与冷却 (Attack Speed)
*   **攻击间隔 (ms)** = `1000 / FinalAttackSpeed`
*   其中 `FinalAttackSpeed` 受“快速咏唱”、“狂战之血”等教条的百分比加成。

### 10.4 升级经验曲线 (XP Curve)
*   **单位升级经验** = `CurrentLevel * 100`
*   **军团升级经验** = `CurrentLegionLevel * 1000`

---

## 11. 强力教条流派 (Builds)

### 11.1 “资本主义”金币流
*   **核心教条**：**贪婪** + **天使投资** + **金弹** + **赏金猎人**。
*   **玩法**：前期堆叠金币获取速度，依靠“天使投资”每分钟 10% 的利息滚雪球。后期“金弹”会根据持有的数万金币提供极其恐怖的伤害加成。

### 11.2 “亡灵天灾”召唤流
*   **核心教条**：**灵魂汲取** + **不洁契约** + **尸爆** + **死亡税**。
*   **玩法**：每击杀一个敌人都有几率产生骷髅兵。通过“不洁契约”，场上骷髅兵越多，你主力部队的伤害就越高。骷髅兵死亡还会触发“死亡税”为全队回血。

### 11.3 “绝对防御”反伤流
*   **核心教条**：**密集阵型** + **荆棘护甲** + **尖刺装甲** + **能量盾**。
*   **玩法**：将所有单位紧密贴合排列。利用“能量盾”将原本单体的反伤变为范围 AOE。适合配合大量的牧师单位，通过不断回血让敌人“打你等于自杀”。

---

## 12. 操控说明

### 12.1 键盘操控
*   **WASD / 方向键**：控制军团移动。
*   **ESC / 空格**：在战斗中可以尝试打开某些 UI（取决于具体配置）。

### 12.2 触摸/鼠标操控
*   **摇杆**：屏幕任意位置按下并拖拽可激活虚拟摇杆。摇杆具备死区（Deadzone）优化，细微的手指抖动不会导致位移。
*   **拖拽**：在战术界面，直接按住单位头像即可进行拖放。
    *   拖向另一个单位：**交换位置**。
    *   拖向垃圾桶：**退役/回收**。
    *   拖向祭坛：**献祭**。

---

## 13. 系统优化与存档

*   **性能控制**：游戏内置了空间网格（Spatial Hash Grid）系统。即使场上有 150 个敌人和 400 个投射物，系统也只计算玩家周围 250 像素内的碰撞，确保移动端流畅。
*   **存档机制**：游戏提供 10 个存档位。存档记录了当前军团的所有单位数据、等级、已选教条以及当前关卡进度。建议在每次更换大阵型后进行保存。

---

## 14. 开发者提示 (Hidden Tips)
*   **献祭 T3 单位**：献祭一个 Tier 3 的终极单位会必然刷出至少一个“传说 (LEGENDARY)”级别的教条供你选择。
*   **复仇判定**：拥有“复仇”教条时，单位在受伤后的下一发子弹不仅是暴击，还会触发所有基于“命中”的特效。
*   **环境缩放**：游戏支持高 DPR (Device Pixel Ratio) 渲染。如果在移动端感到卡顿，可以尝试在非视网膜屏幕模式下运行。

**—— 祝你在军团征程中生存到最后！ ——**